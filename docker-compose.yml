version: "3.7"
services:
  web1:
    container_name: web1
    build:
      context: .
      dockerfile: docs/docker/web1.Dockerfile
    depends_on:
      - mail_balancer
  web2:
    container_name: web2
    build:
      context: .
      dockerfile: docs/docker/web1.Dockerfile
    depends_on:
      - mail_balancer
  serv1:
    container_name: serv1
    build:
      context: .
      dockerfile: docs/docker/serv1.Dockerfile
  service_balancer:
    container_name: service_balancer
    build:
      context: .
      dockerfile: service_haproxy/haproxy.Dockerfile
    ports:
      - 84:84
      - 83:83
    depends_on:
      - web1
  mail_balancer:
    container_name: mail_balancer
    build:
      context: .
      dockerfile: mail_haproxy/haproxy.Dockerfile
    ports:
      - 8080:8080
      - 82:82
    depends_on:
      - serv1
 
